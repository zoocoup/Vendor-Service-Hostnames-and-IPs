# These are the hosts and IPs associated with Office 365 service
#
# Microsoft 365 network connectivity test
# https://connectivity.office.com
# 
# Office 365 URLs and IP address ranges > Microsoft 365 Common and Office Online
# https://docs.microsoft.com/en-us/microsoft-365/enterprise/urls-and-ip-address-ranges?view=o365-worldwide
# 
# Other endpoints not included in the Office 365 IP Address and URL Web service
# https://docs.microsoft.com/en-us/microsoft-365/enterprise/networking-roadmap-microsoft-365?view=o365-worldwide

# Last edit: 20230715

_Hostnames_
#  Wildcards and prime top domain roots
*.aadrm.com
*.acompli.net
*.api.microsoftstream.com
*.appex-rf.msn.com
*.appex.bing.com
*.aria.microsoft.com
*.azure-apim.net
*.azureedge.net
*.azurerms.com
*.blob.core.windows.net
*.cdn.office.net
*.chinacloudapi.cn 
*.cloudapp.net
*.cloudapp.net 
*.compliance.microsoft.com
*.config.office.net
*.cortana.ai	
*.digicert.com:80 
*.entrust.net
*.entrust.net:80 
*.events.data.microsoft.com
*.flow.microsoft.com
*.geotrust.com
*.helpshift.com
*.hip.live.com
*.hockeyapp.net
*.informationprotection.azure.com
*.itunes.apple.com
*.keydelivery.mediaservices.windows.net
*.localytics.com
*.manage.microsoft.com
*.media.azure.net
*.microsoft.com
*.microsoftonline-p.com
*.microsoftonline.com
*.microsoftstream.com
*.microsoftusercontent.com
*.msappproxy.net
*.msauth.net
*.msauthimages.net
*.msecnd.net
*.msftauth.net
*.msftauthimages.net
*.msftidentity.com
*.msidentity.com
*.msocdn.com
*.notification.api.microsoftstream.com
*.o365weve.com
*.office.com
*.office.net
*.office365.com
*.officeapps.live.com
*.omniroot.com
*.onenote.com
*.online.office.com
*.onmicrosoft.com
*.outlookmobile.com
*.partner.microsoftonline.cn
*.phonefactor.net
*.portal.cloudappsecurity.com
*.powerapps.com
*.protection.office.com
*.public-trust.com
*.security.microsoft.com
*.sharepointonline.com
*.store.core.windows.net
*.streaming.mediaservices.windows.net
*.symcb.com
*.symcd.com
*.verisign.com
*.verisign.net
*.virtualearth.net


RegEx that should work for wildcard domains, at least for hostnames with letters, numbers, dash or period in the name: ^(([a-zA-Z0-9]|[a-zA-Z0-9][a-zA-Z0-9\-\.]*[a-zA-Z0-9])\.)example.com

# Rest of the domains
account.activedirectory.windowsazure.com
account.live.com
account.office.net
accounts.accesscontrol.windows.net
accounts.google.com
activation.sls.microsoft.com
activity.windows.com
ad.atdmt.com
admin.microsoft.com
adminwebservice.microsoftonline.com
ajax.aspnetcdn.com
aka.ms
amp.azure.net
api.diagnostics.office.com
api.dropboxapi.com
api.login.yahoo.com
api.meetup.com
api.microsoftstream.com
api.passwordreset.microsoftonline.com
apibasic.diagnostics.office.com
apis.live.net
app.adjust.com
app.box.com
apps.identrust.com
appsforoffice.microsoft.com
asl.configure.office.com
assets.onestore.ms
auth.gfx.ms
autodiscover-s.outlook.com
autodiscover.outlook.com
autologon.microsoftazuread-sso.com
az416426.vo.msecnd.net
becws.microsoftonline.com
bit.ly
by.uservoice.com
c.bing.com
c.bing.net
c.live.com
c1.microsoft.com
cacerts.digicert.com
cdn.odc.officeapps.live.com
cdn.onenote.net
cdn.optimizely.com
cdn.uci.officeapps.live.com
cdnprod.myanalytics.microsoft.com
cert.int-x3.letsencrypt.org
cl2.apple.com
clientconfig.microsoftonline-p.net
cloudcheckenabler.azurewebsites.net
companymanager.microsoftonline.com
compliance.microsoft.com
connect.facebook.net
contentstorage.osi.office.net
crl.globalsign.com
crl.globalsign.net
crl.identrust.com
crl.microsoft.com
crl3.digicert.com
crl4.digicert.com
d.docs.live.net
data.flurry.com
dc.services.visualstudio.com
device.login.microsoftonline.com
dgps.support.microsoft.com
directory.services.live.com
docs.live.net
docs.microsoft.com
domains.live.com
ecn.dev.virtualearth.net
edunotebookssite-cdn.onenote.net
enterpriseregistration.windows.net
excel.officeapps.live.com
excelbingmap.firstpartyapps.oaspapps.com
firstpartyapps.oaspapps.com
fs.microsoft.com
go.microsoft.com
graph.facebook.com
graph.microsoft.com
graph.windows.net
informationprotection.hosting.portal.azure.net
insertmedia.bing.office.net
isrg.trustid.ocsp.identrust.com
login-us.microsoftonline.com
login.live.com
login.microsoft.com
login.microsoftonline-p.com
login.microsoftonline.com
login.windows-ppe.net
login.windows.net
logincert.microsoftonline.com
loginex.microsoftonline.com
m.facebook.com
mail.google.com
management.azure.com
mem.gfx.ms
mscrl.microsoft.com
msdn.microsoft.com
mshybridservice.trafficmanager.net
myanalytics-gcc.microsoft.com
myanalytics.microsoft.com
nexus.microsoftonline-p.com
nps.onyx.azure.net
o15.officeredir.microsoft.com
o365diagtelemetry.trafficmanager.net
ocos-office365-s2s.msedge.net
ocsp.digicert.com
ocsp.globalsign.com
ocsp.int-x3.letsencrypt.org
ocsp.msocsp.com
ocsp2.globalsign.com
ocspx.digicert.com
odc.officeapps.live.com
offcatedge.azureedge.net
office.live.com
office15client.microsoft.com
officeapps.live.com
officecdn.microsoft.com
officecdn.microsoft.com.edgesuite.net
officecdnmac.microsoft.com
officeci-mauservice.azurewebsites.net
officeclient.microsoft.com
officepreviewredir.microsoft.com
officeredir.microsoft.com
officespeech.platform.bing.com
outlook.office365.com
outlook.uservoice.com
outlookdiagnostics.azureedge.net
partnerservices.getmicrosoftkey.com
passwordreset.microsoftonline.com
peoplegraph.firstpartyapps.oaspapps.com
platform.linkedin.com
play.google.com
policykeyservice.dc.ad.msft.net
prod.firstpartyapps.oaspapps.com.akadns.net
prod.msocdn.com
protection.office.com
provisioningapi.microsoftonline.com
r.office.microsoft.com
res-1.cdn.office.net
s.ytimg.com
s0.assets-yammer.com
secure.aadcdn.partner.microsoftonline-p.cn
secure.globalsign.com
secure.meetup.com
security.microsoft.com
shcwreleaseprod.blob.core.windows.net
shellprod.msocdn.com
signup.live.com
site-cdn.onenote.net
social.yahooapis.com
staffhub.ms
staffhub.uservoice.com
suite.office.net
support.content.office.net
support.microsoft.com
tds.configure.office.com
technet.microsoft.com
telemetryservice.firstpartyapps.oaspapps.com
tse1.mm.bing.net
videocontent.osi.office.net
videoplayercdn.osi.office.net
view.atdmt.com
vortex.data.microsoft.com
web.microsoftstream.com
wikipedia.firstpartyapps.oaspapps.com
workplaceanalytics.cdn.office.net
wus-firstpartyapps.oaspapps.com


_IPs_
104.215.12.254
104.215.13.23
104.215.18.55
104.215.6.169
13.107.140.6/32
13.107.18.15/32
13.107.6.171/32
13.107.64.0/18
13.85.192.123
13.85.192.59
13.86.37.15
13.87.81.123
13.87.81.133
13.87.81.141
13.87.81.35
13.89.104.147
13.89.108.233
137.135.11.116
137.135.11.161
137.135.11.222
137.135.11.250
20.111.9.46
20.111.9.77
20.190.128.0/18
20.199.102.157
20.199.102.73
20.44.210.146
20.44.210.83
20.48.11.201
20.48.12.75
20.48.14.35
20.48.15.147
20.69.245.215
20.96.21.115
20.96.21.67
20.96.21.98
2603:1006:1400::/40
2603:1006:2000::/48
2603:1007:200::/48
2603:1010:200::c7/128
2603:1010:2::cb/128
2603:1016:1400::/48
2603:1016:2400::/40
2603:1017::/48
2603:1020:200::682f:a0fd/128
2603:1020:201:9::c6/128
2603:1020:600::a1/128
2603:1020:700::a2/128
2603:1020:800:2::6/128
2603:1020:900::8/128
2603:1026:2400::/40
2603:1026:3000::/48
2603:1027:1::/48
2603:1030:1000::21a/128
2603:1030:7::749/128
2603:1030:800:5::bfee:ad3c/128
2603:1030:f00::17/128
2603:1036:2400::/40
2603:1036:3000::/48
2603:1037:1::/48
2603:1040:200::4f3/128
2603:1040:401::762/128
2603:1040:601::60f/128
2603:1040:a01::1e/128
2603:1040:c01::28/128
2603:1040:e00:1::2f/128
2603:1040:f00::1f/128
2603:1046:1400::/40
2603:1046:2000::/48
2603:1047:1::/48
2603:1050:1::cd/128
2603:1056:1400::/40
2603:1056:2000::/48
2603:1057:2::/48
2620:1ec:8fc::6/128
2620:1ec:a92::171/128
2620:1ec:c::15/128
2a01:111:200a:a::/64
2a01:111:2035:8::/64
2a01:111:f100:2000::a83e:3019/128
2a01:111:f100:2002::8975:2d79/128
2a01:111:f100:2002::8975:2da8/128
2a01:111:f100:7000::6fdd:6cd5/128
2a01:111:f100:a004::bfeb:88cf/128	
2a01:111:f406:1004::/64
2a01:111:f406:1805::/64
2a01:111:f406:1::/64
2a01:111:f406:3404::/64
2a01:111:f406:8000::/64
2a01:111:f406:8801::/64
2a01:111:f406:a003::/64
2a01:111:f406:c00::/64
40.125.136.69
40.125.138.23
40.126.0.0/18
40.72.155.199
40.72.155.216
40.74.203.27
40.74.203.28
40.76.162.42
40.76.162.99
40.80.232.118
40.80.232.177
40.80.233.14
40.80.239.196
42.159.180.55
42.159.180.56
42.159.72.35
42.159.72.47
51.104.159.181
51.104.159.213
51.124.73.177
51.124.75.43
51.138.90.52
51.138.90.7
52.108.0.0/14
52.112.0.0/14
52.142.114.29
52.142.115.31
52.147.213.181
52.147.213.251
52.148.114.238
52.148.115.48
52.148.24.136
52.148.27.39
52.151.30.78
52.154.246.238
52.159.102.72
52.159.107.4
52.159.107.50
52.159.109.205
52.159.17.84
52.159.23.209
52.181.24.199
52.181.24.220
52.181.25.66
52.181.25.67
52.182.25.110
52.182.25.254
52.182.32.143
52.182.32.51
52.183.67.212
52.191.173.85
52.229.38.131
52.238.106.116/32
52.243.147.249
52.243.148.19
52.243.157.104
52.243.157.105
52.244.111.156
52.244.111.170
52.244.203.72/32
52.244.207.172/32
52.244.223.198/32
52.244.35.174
52.244.37.168/32
52.247.150.191/32
